<img width="796" alt="image" src="https://github.com/FredrikAkerlund/Starting-pentesting/assets/122887178/563fe60c-1dc8-4ace-b1f9-20f0f732a120">## Sieppari ruispellossa
Tehtävänä on siepata ja analysoida omaa verkkoliikennettä. Tehtäväässä käytän linux virtuaalikonetta. Distrona on Kali Linux ja ohjelmistona käytän valmiiksi asennettua Wireshark sovellusta.
### Aloitus
Wiresharkista valitsen eth0 portin joka on Virtualboxin luoma virtuaaliverkkokortti. Luodakseni liikenettä avaan selaimen ja siirryn google.com sivustolle.
Rajatakseni liikenteen määrää lisään sieppaukseen filtterin joka näyttää minulle vain kaiken TCP liikenteen.

<img width="802" alt="image" src="https://github.com/FredrikAkerlund/Starting-pentesting/assets/122887178/f9544433-4a96-4ac1-aef9-4339ed417384">

Natiivikoneessa minulla on käytössä OpenVPN sovellus käytössä joka reitittää kaiken liikenteeni VPN palvelimen kautta.
Virtuaalikoneen IP osoite on 10.0.2.15 joka on virtualbox virtuaalireitittimen DHCP antama osoite.

### 44.230.179.24 Selaimen kotisivu

IP-osoite 44.230.179.24 on Amazonin AWS pilvipalvu verkko-osoite. Saan selville tämän käyttämällä nslookup 44.230.179.24 komentoa.

    nslookup 44.230.179.24
Oletan että tämä liikenne on mozillan firefoxin oletussivu. 

<img width="796" alt="image" src="https://github.com/FredrikAkerlund/Starting-pentesting/assets/122887178/9bb920e0-536c-4688-a284-3431a5c2f6cf">

Ylläolevassa kuvankaappauksessa näen että paketit no 5-17 on handshake palvelun kanssa. Handshake vaiheessa palvelin ja oma tietokone vaihtaa julkisia avaimia ja palvelin generoi istuntoavaimen. Avaimia vaihdetaan koska sivusto toimii HTTPS protokollalla.
Kuvankaappauksessa näkyy myös että liikenne kohdistuu Amazonin hostamaan palveluun porttiin 443 jota käytetään HTTPS liikenteelle. Oma virtuaalikone käyttää porttia 32966.
Tämä portti on generoitu juuri tätä kyseistä istuntoa varten. 

### Mysteeri 62.115.253.187 sekä 34.117.237.239 Google.com

Paketinkaappauksessa seuraavaa liikenne on osoitteeseen 62.115.253.187. Selvitän mikä tämä osoite on nslookup 62.115.253.187 komennolla.
<img width="926" alt="image" src="https://github.com/FredrikAkerlund/Starting-pentesting/assets/122887178/71d54f99-5e61-4073-8c35-70312a7ca1ee">

    nslookup 62.115.253.187
Vastauksena saan että IP osoitteen DNS nimi ei löydy. Kuitenkin kokeilemalla google haulla "whois 62.115.253.187" saan vastauksen että kyse on osoite joka on akamain hallinoima.
Akamai on pilvipalveluita tarjoava yritys. Ip osoite saattaa liittyä VPN palveluuni. Tätä liikenettä en osaa selittää.'
Liikenne kohdistuu porttiin 80 jota käyttää HTTP liikenne. Oletan että liikenne liittyy reititykseen.

Seuraava liikenne on osoitteeseen 34.117.237.239 joka on Googlen osoite. Paketinkaappauksessa näkyy samanalaista liikenettä mitä tapahtui Firefoxin oletussivulla.
Kyseessä on HTTPS liikenettä porttiin 443. Oma tietokone käyttää porttia 33430

### Yhteenveto

Verkkokaappauksessa näkyy paljon liikenettä enkä osaa varmaksi sanoa mikä kaikki liikenne on. Kuitenkin tunnistin liikenteestä muutaman asian joka kohdistuu portteihin 80 ja 443.
Liikenteessä näkyy 4-way handshake eri palvelimien kanssa missä tapahtuu avainten vaihtoa. Lisäksi liikenteessä näkyy myös VPN reititystä. Näin oletan.


